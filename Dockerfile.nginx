FROM nginx:alpine

RUN mkdir -p /usr/share/nginx/html /etc/nginx/templates

COPY nginx.conf /etc/nginx/templates/default.conf.template 

COPY client/dist /usr/share/nginx/html

EXPOSE 80

CMD ["/bin/sh", "-c", "envsubst '${SERVER_IP}' < /etc/nginx/templates/default.conf.template > /etc/nginx/conf.d/default.conf && nginx -g 'daemon off;'"]
